"use strict";function TodayQuery(){var e=new Date;e.setHours(23,59,59,99);var t=new Date;return t.setHours(0,0,0,1),{$and:[{Date:{$lte:e}},{Date:{$gt:t}}]}}function PatientsList(e,t,n){var t=TodayQuery();e.query({query:encodeURIComponent(JSON.stringify(t))},function(e,t){e&&0===e.code&&n(e.value,t)})}function List(e,t,n){e.query({query:encodeURIComponent(JSON.stringify(t))},function(e){e&&0===e.code&&n(e.value)})}var _this=this,controllers=angular.module("AccountControllers",["ngMaterial","ngResource","ngMessages","ngMdIcons","ngAnimate","flow"]);controllers.value("Global",{socket:null}),controllers.value("CurrentPatient",{id:""}),controllers.value("CurrentView",{Page:0,Data:{}}),controllers.value("CurrentAccount",{username:"",type:""}),controllers.factory("ViewItem",["$resource",function(e){return e("/view",{},{})}]),controllers.factory("Login",["$resource",function(e){return e("/account/login",{},{login:{method:"POST"}})}]),controllers.factory("Logout",["$resource",function(e){return e("/account/logout",{},{logout:{method:"POST"}})}]),controllers.factory("AccountQuery",["$resource",function(e){return e("/account/query/:query",{query:"@query"},{query:{method:"GET"}})}]),controllers.factory("Account",["$resource",function(e){return e("/account/:id",{},{get:{method:"GET"},update:{method:"PUT"},remove:{method:"DELETE"}})}]),controllers.factory("AccountPassword",["$resource",function(e){return e("/account/password/:id",{},{update:{method:"PUT"}})}]),controllers.factory("AccountCreate",["$resource",function(e){return e("/account/create",{},{})}]),controllers.factory("PatientAccept",["$resource",function(e){return e("/patient/accept",{},{})}]),controllers.factory("PatientQuery",["$resource",function(e){return e("/patient/query/:query",{query:"@query"},{query:{method:"GET"}})}]),controllers.factory("PatientCount",["$resource",function(e){return e("/patient/count/:query",{query:"@query"},{query:{method:"GET"}})}]),controllers.factory("Patient",["$resource",function(e){return e("/patient/:id",{},{update:{method:"PUT"},remove:{method:"DELETE"}})}]),controllers.factory("PatientStatus",["$resource",function(e){return e("/patient/status/:id",{},{update:{method:"PUT"}})}]),controllers.factory("ViewCreate",["$resource",function(e){return e("/view/create",{},{})}]),controllers.factory("View",["$resource",function(e){return e("/view/:id",{},{update:{method:"PUT"},remove:{method:"DELETE"}})}]),controllers.factory("ViewQuery",["$resource",function(e){return e("/view/query/:query",{query:"@query"},{query:{method:"GET"}})}]),controllers.factory("Config",["$resource",function(e){return e("/config",{},{update:{method:"PUT"}})}]),controllers.factory("File",["$resource",function(e){return e("/file/:name",{name:"@name"},{send:{method:"POST"},update:{method:"PUT"}})}]),controllers.factory("FileQuery",["$resource",function(e){return e("/file/query/:query",{query:"@query"},{query:{method:"GET"}})}]),controllers.factory("Pdf",["$resource",function(e){return e("/pdf/:id",{},{})}]),controllers.controller("StartController",["$scope","$state","CurrentAccount",function(e,t,n){""!==n.username?(e.username=n.username,e.type=n.type):t.go("start")}]),controllers.controller("ApplicationController",["$scope","$rootScope","$state","$mdDialog","$mdToast","$mdSidenav","$mdUtil","Login","Logout","CurrentAccount","Global",function(e,t,n,o,a,i,r,c,l,s,u){function g(){var e=r.debounce(function(){i("nav").toggle().then(function(){})},300);return e}if(e.goBack=function(){window.history.back()},e.goTop=function(){n.go("start")},e.goConfig=function(){n.go("controlles")},e.goEdit=function(){n.go("departments")},e.goPatient=function(){e.mode="Patient",n.go("patients")},e.goAccount=function(){e.mode="Account",n.go("accounts")},e.open=g(),e.close=function(){i("nav").close().then(function(){})},e.showLoginDialog=function(){o.show({controller:"LoginDialogController",templateUrl:"/backend/partials/account/logindialog",targetEvent:null}).then(function(n){s.username=n.value.username,s.type=n.value.type,e.username=n.value.username,e.type=n.value.type,localStorage.setItem("account",JSON.stringify(s)),t.$broadcast("Login")},function(){})},e.Logout=function(){var o=new l;o.$logout(function(o){o?(0===o.code&&(s.username="",s.type="",e.username="",e.type="",localStorage.removeItem("account"),t.$broadcast("Logout"),n.go("start")),a.show(a.simple().content(o.message))):a.show(a.simple().content("network error(logout)"))})},null===u.socket&&(u.socket=io.connect()),null!==localStorage.getItem("account")){var m=JSON.parse(localStorage.getItem("account"));s.username=m.username,s.type=m.type}else e.showLoginDialog();e.username=s.username,e.type=s.type,e.mode="Account"}]),controllers.controller("PatientsController",["$scope","$state","$stateParams","$q","$mdDialog","$mdBottomSheet","$mdToast","Patient","PatientAccept","PatientQuery","PatientCount","CurrentAccount","CurrentPatient","Global",function(e,t,n,o,a,i,r,c,l,s,u,g,m,d){""!==g.username?(e.username=g.username,e.type=g.type,e.progress=!0,PatientsList(s,{},function(t){e.patients=t,e.progress=!1}),e.showPatientDescription=function(e){m.id=e,n.id=e,t.go("description",{id:e})},e.icon="vertical_align_top",e.showSheet=function(t){e.icon="vertical_align_bottom",i.show({templateUrl:"/backend/partials/patient/sheet",controller:"PatientSheetControl",targetEvent:t}).then(function(t){e.icon="vertical_align_top"},function(){e.icon="vertical_align_top"})},e.showPatientAcceptDialog=function(t){var n=TodayQuery();u.query({query:encodeURIComponent(JSON.stringify(n))},function(n){if(n&&0===n.code){var o={count:0};o.count=n.value,a.show({controller:"PatientAcceptDialogController",templateUrl:"/backend/partials/patient/patientacceptdialog",targetEvent:t,locals:{items:o}}).then(function(t){var n=new l;n.Input={},n.Information={},n.Information.name=t.items.name;var a=new Date,i=("0"+a.getHours()).slice(-2),c=("0"+a.getMinutes()).slice(-2),u=("0"+a.getSeconds()).slice(-2);n.Information.time=i+":"+c+":"+u,t.items.kana=t.items.kana.replace(/[ぁ-ん]/g,function(e){return String.fromCharCode(e.charCodeAt(0)+96)}),n.Information.kana=t.items.kana,n.Information.insurance=t.items.insurance,n.Category=t.items.category,n.Sequential=o.count,e.progress=!0,n.$save({},function(t){t?(0===t.code&&PatientsList(s,{},function(t){e.progress=!1,d.socket.emit("server",{value:"1"}),e.patients=t}),r.show(r.simple().content(t.message))):r.show(r.simple().content("network error(save)"))})},function(){})}})},e.querySearch=function(e){var t=o.defer(),n=TodayQuery();return s.query({query:encodeURIComponent(JSON.stringify({$and:[n,{"Information.name":{$regex:e}}]}))},function(e){t.resolve(e.value)}),t.promise},e.searchTextChange=function(e){},e.selectedItemChange=function(e){},e.$on("Login",function(){e.progress=!0,PatientsList(s,{},function(t){e.patients=t,e.progress=!1})}),e.$on("Logout",function(){g.username="",g.type="",e.patients=[]}),e.$on("Update",function(){e.progress=!0,PatientsList(s,{},function(t){e.patients=t,e.progress=!1})}),d.socket.on("client",function(t){"1"===t.value&&(e.progress=!0,PatientsList(s,{},function(t){e.patients=t,e.progress=!1}))}),e.showTotalSheet=function(t){e.icon="vertical_align_bottom",i.show({templateUrl:"/backend/partials/patient/totalsheet",controller:"PatientTotalSheetControl",targetEvent:t}).then(function(t){e.icon="vertical_align_top"},function(){e.icon="vertical_align_top"})}):t.go("start")}]),controllers.controller("DescriptionController",["$scope","$mdBottomSheet","$mdToast","Patient","PatientStatus","CurrentAccount","CurrentPatient","Pdf","Global",function(e,t,n,o,a,i,r,c,l){if(r){e.selectedIndex=0,e.load=function(){var t=new o;t.$get({id:r.id},function(t){t?(0===t.code&&(e.Input=[],_.each(t.value.Input,function(n,o,a){if("picture"===n.type){var i=new fabric.Canvas("schema-"+n.name);i.loadFromJSON(JSON.stringify(n.value),i.renderAll.bind(i),function(e,t){})}e.Input.push(n),e.Information=t.value.Information})),n.show(n.simple().content(t.message))):n.show(n.simple().content("network error(patient)"))})};var s=new a;s.$get({id:r.id},function(t){t?(0===t.code&&(e.IsDone="Done"===t.value),n.show(n.simple().content(t.message))):n.show(n.simple().content("network error(status)"))}),e.icon="vertical_align_top",e.showSheet=function(n){e.icon="vertical_align_bottom",t.show({templateUrl:"/backend/partials/patient/sheet",controller:"PatientSheetControl",targetEvent:n}).then(function(t){e.icon="vertical_align_top"},function(){e.icon="vertical_align_top"})},e.done=function(){var e=new o;e.$remove({id:r.id},function(e){n.show(e?n.simple().content(e.message):n.simple().content("network error(patient)"))})},e.download=function(e){var t=document.getElementById(e);Canvas2Image.saveAsPNG(t)},e.$watch("IsDone",function(){if(null!==e.IsDone){var t=new a;t.$get({id:r.id},function(o){o?0===o.code?e.IsDone===!0?"Done"!==o.value&&(t.Status="Done",t.$update({id:r.id},function(e){e?(0===e.code&&l.socket.emit("server",{value:"1"}),n.show(n.simple().content(e.message))):n.show(n.simple().content("network error(status)"))})):"Accepted"!==o.value&&(t.Status="Accepted",t.$update({id:r.id},function(e){e?(0===e.code&&l.socket.emit("server",{value:"1"}),n.show(n.simple().content(e.message))):n.show(n.simple().content("network error(login)"))})):n.show(n.simple().content(o.message)):n.show(n.simple().content("network error(login)"))})}})}}]),controllers.controller("AccountsController",["$scope","$state","$mdDialog","$mdToast","Account","AccountQuery","AccountCreate","AccountPassword","CurrentAccount",function(e,t,n,o,a,i,r,c,l){""!==l.username?(e.username=l.username,e.type=l.type,e.progress=!0,List(i,{},function(t){e.progress=!1,e.accounts=t}),e.showRegisterDialog=function(){n.show({controller:"RegisterDialogController",templateUrl:"/backend/partials/account/registerdialog",targetEvent:null}).then(function(t){var n=new r;n.username=t.items.username,n.password=t.items.password,n.type=t.items.type,e.progress=!0,n.$save({},function(t){t?(0===t.code&&List(i,{},function(t){e.accounts=t,e.progress=!1}),o.show(o.simple().content(t.message))):o.show(o.simple().content("network error(status)"))})},function(){})},e.showAccountDeleteDialog=function(t){n.show({controller:"AccountDeleteDialogController",templateUrl:"/backend/partials/account/deletedialog",targetEvent:t}).then(function(n){var r=new a;e.progress=!0,r.$remove({id:t},function(t){t?(0===t.code&&List(i,{},function(t){e.accounts=t,e.progress=!1}),o.show(o.simple().content(t.message))):o.show(o.simple().content("network error(status)"))})},function(){})},e.showAccountUpdateDialog=function(t){var r=new a;r.$get({id:t},function(r){r&&(0===r.code?(e.items=r.value,e.items.password="",n.show({controller:"AccountUpdateDialogController",templateUrl:"/backend/partials/account/accountdialog",targetEvent:t,locals:{items:e.items}}).then(function(n){switch(n.a){case 1:var r=new c;r.password=n.items.password,r.$update({id:t},function(e){o.show(e?o.simple().content(e.message):o.simple().content("network error(password)"))});case 2:var r=new a;r.username=n.items.username,r.type=n.items.type,e.progress=!0,r.$update({id:t},function(t){t?(0===t.code&&List(i,{},function(t){e.accounts=t,e.progress=!1}),o.show(o.simple().content(t.message))):o.show(o.simple().content("network error(account)"))})}},function(){})):o.show(o.simple().content(r.message)))})},e.$on("Login",function(){e.progress=!0,List(i,{},function(t){e.accounts=t,e.progress=!1})}),e.$on("Logout",function(){e.accounts=[]}),e.$on("Update",function(){e.progress=!0,List(i,{},function(t){e.accounts=t,e.progress=!1})})):t.go("start")}]),controllers.controller("DepartmentsController",["$scope","$state","$mdDialog","$mdToast","CurrentView","ViewCreate","View","ViewQuery",function(e,t,n,o,a,i,r,c){e.progress=!0,List(c,{},function(t){e.Departments=t,e.progress=!1}),e.back=function(){window.history.back()},e.showDepartmentCreateDialog=function(){n.show({controller:"DepartmentCreateDialogController",templateUrl:"/backend/partials/edit/departmentcreatedialog",targetEvent:null}).then(function(t){var n=new i;n.Name=t.items.department,n.$save({},function(t){t?(0===t.code&&(e.progress=!0,List(c,{},function(t){e.Departments=t,e.progress=!1})),o.show(o.simple().content(t.message))):o.show(o.simple().content("network error(save)"))})},function(){})},e.showDepartmentCopyDialog=function(t){var a=new r;a.$get({id:t},function(t){n.show({controller:"DepartmentCopyDialogController",templateUrl:"/backend/partials/edit/departmentcopydialog",targetEvent:null,locals:{items:a}}).then(function(n){var a=new i;a.Pages=t.value.Pages,a.Name=n.items.department,a.$save({},function(t){t?(0===t.code&&(e.progress=!0,List(c,{},function(t){e.Departments=t,e.progress=!1})),o.show(o.simple().content(t.message))):o.show(o.simple().content("network error(save)"))})},function(){})})},e.DepartmentUpdate=function(n){var o=new r;o.$get({id:n},function(n){a.Data=n.value,e.Pages=a.Data.Pages,t.go("department")})},e.showDepartmentDeleteDialog=function(t){n.show({controller:"DepartmentDeleteDialogController",templateUrl:"/backend/partials/edit/departmentdeletedialog",targetEvent:t}).then(function(n){var a=new r;e.progress=!0,a.$remove({id:t},function(t){t?(0===t.code&&(e.progress=!0,List(c,{},function(t){e.Departments=t,e.progress=!1})),o.show(o.simple().content(t.message))):o.show(o.simple().content("network error(save)"))})},function(){})}}]),controllers.controller("DepartmentEditController",["$scope","$state","$mdDialog","$mdToast","CurrentView","View",function(e,t,n,o,a,i){a.Data?(e.Title=a.Data.Name,e.Pages=a.Data.Pages,e.back=function(){window.history.back()},e.up=function(e){if(e>0){var t=a.Data.Pages[e];a.Data.Pages[e]=a.Data.Pages[e-1],a.Data.Pages[e-1]=t}},e.down=function(e){if(e<a.Data.Pages.length-1){var t=a.Data.Pages[e];a.Data.Pages[e]=a.Data.Pages[e+1],a.Data.Pages[e+1]=t}},e.DepartmentUpdate=function(){var e=new i;e.Name=a.Data.Name,e.Pages=a.Data.Pages,e.$update({id:a.Data._id},function(e){o.show(e?0===e.code?o.simple().content(e.message):o.simple().content(e.message):o.simple().content("network error(account)"))})},e.showPageCreateDialog=function(){n.show({controller:"PageCreateDialogController",templateUrl:"/backend/partials/edit/pagecreatedialog",targetEvent:null}).then(function(t){var n=t.items.title,o={headline:n,items:[],picture:[]};a.Data.Pages||(a.Data.Pages=[]),a.Data.Pages.push(o),e.Pages=a.Data.Pages},function(){})},e.PageUpdate=function(e){a.Page=e,t.go("page")},e.showPageDeleteDialog=function(t){n.show({controller:"PageDeleteDialogController",templateUrl:"/backend/partials/edit/pagedeletedialog",targetEvent:t}).then(function(n){a.Data.Pages[t]=null,a.Data.Pages=_.compact(a.Data.Pages),e.Pages=a.Data.Pages},function(){})}):t.go("departments")}]),controllers.controller("PageEditController",["$scope","$state","$mdDialog","$mdToast","CurrentView","View",function(e,t,n,o,a,i){a.Data.Pages?(e.Page=a.Data.Pages[a.Page],e.back=function(){window.history.back()},e.up=function(e){if(e>0){var t=a.Data.Pages[a.Page].items[e];a.Data.Pages[a.Page].items[e]=a.Data.Pages[a.Page].items[e-1],a.Data.Pages[a.Page].items[e-1]=t}},e.down=function(e){if(e<a.Data.Pages[a.Page].items.length-1){var t=a.Data.Pages[a.Page].items[e];a.Data.Pages[a.Page].items[e]=a.Data.Pages[a.Page].items[e+1],a.Data.Pages[a.Page].items[e+1]=t}},e.DepartmentUpdate=function(){var e=new i;e.Name=a.Data.Name,e.Pages=a.Data.Pages,e.$update({id:a.Data._id},function(e){o.show(e?0===e.code?o.simple().content(e.message):o.simple().content(e.message):o.simple().content("network error(account)"))})},e.showTextCreateDialog=function(){n.show({controller:"TextCreateDialogController",templateUrl:"/backend/partials/edit/item/text/textcreatedialog",targetEvent:null}).then(function(e){var t={label:e.items.label,name:e.items.name,model:"",type:"text",items:[{name:"required",message:"Required"},{name:"md-maxlength",message:"Max"}]};a.Data.Pages[a.Page].items.push(t)},function(){})},e.showCheckCreateDialog=function(){n.show({controller:"CheckCreateDialogController",templateUrl:"/backend/partials/edit/item/check/checkcreatedialog",targetEvent:null}).then(function(e){var t={label:e.items.label,name:e.items.name+"-"+e.items.label,model:"",type:"check"};a.Data.Pages[a.Page].items.push(t)},function(){})},e.showSelectCreateDialog=function(){n.show({controller:"SelectCreateDialogController",templateUrl:"/backend/partials/edit/item/select/selectcreatedialog",targetEvent:null}).then(function(e){var t={label:e.items.label,name:e.items.name,model:"",type:"select",items:e.tags};a.Data.Pages[a.Page].items.push(t)},function(){})},e.showNumericCreateDialog=function(){n.show({controller:"NumericCreateDialogController",templateUrl:"/backend/partials/edit/item/numeric/numericcreatedialog",targetEvent:null}).then(function(e){var t={label:e.items.label,name:e.items.name,model:"",type:"numeric"};a.Data.Pages[a.Page].items.push(t)},function(){})},e.showPictureCreateDialog=function(){n.show({controller:"PictureCreateDialogController",templateUrl:"/backend/partials/edit/item/picture/picturecreatedialog",targetEvent:null}).then(function(e){var t={height:600,width:300,path:e.items.path,type:"picture",model:"",name:e.items.name,label:e.items.label};a.Data.Pages[a.Page].picture[0]=t},function(){})},e.showPictureUpdateDialog=function(e){var t=a.Data.Pages[a.Page].picture[0];n.show({controller:"PictureUpdateDialogController",templateUrl:"/backend/partials/edit/item/picture/pictureupdatedialog",targetEvent:null,locals:{items:t}}).then(function(e){var t={height:600,width:300,path:e.items.path,type:"picture",model:"",name:e.items.name,label:e.items.label};a.Data.Pages[a.Page].picture[0]=t},function(){})},e.showButtonCreateDialog=function(){var e={type:"button",validate:!0,"class":"md-accent"};n.show({controller:"ButtonCreateDialogController",templateUrl:"/backend/partials/edit/item/button/buttoncreatedialog",targetEvent:null,locals:{items:e}}).then(function(e){var t="";t=e.isPage?"/browse/"+e.items.page:"/write";var n={label:e.items.label,name:e.items.name,model:"",type:"button",validate:e.items.validate,path:t,"class":e.items["class"]};a.Data.Pages[a.Page].items.push(n)},function(){})},e.showTextUpdateDialog=function(e){var t=a.Data.Pages[a.Page].items[e];n.show({controller:"TextUpdateDialogController",templateUrl:"/backend/partials/edit/item/check/textupdatedialog",targetEvent:null,locals:{items:t}}).then(function(t){a.Data.Pages[a.Page].items[e]=t.items},function(){})},e.showCheckUpdateDialog=function(e){var t=a.Data.Pages[a.Page].items[e];t.name=t.name.split("-")[0],n.show({controller:"CheckUpdateDialogController",templateUrl:"/backend/partials/edit/item/check/checkupdatedialog",targetEvent:null,locals:{items:t}}).then(function(t){t.items.name=t.items.name+"-"+t.items.label,a.Data.Pages[a.Page].items[e]=t.items},function(){})},e.showSelectUpdateDialog=function(e){var t=a.Data.Pages[a.Page].items[e];n.show({controller:"SelectUpdateDialogController",templateUrl:"/backend/partials/edit/item/select/selectupdatedialog",targetEvent:null,locals:{items:t}}).then(function(t){a.Data.Pages[a.Page].items[e]=t.items},function(){})},e.showNumericUpdateDialog=function(e){var t=a.Data.Pages[a.Page].items[e];n.show({controller:"NumericUpdateDialogController",templateUrl:"/backend/partials/edit/item/numeric/numericupdatedialog",targetEvent:null,locals:{items:t}}).then(function(t){a.Data.Pages[a.Page].items[e]=t.items},function(){})},e.showButtonUpdateDialog=function(e){var t=a.Data.Pages[a.Page].items[e];n.show({controller:"ButtonUpdateDialogController",templateUrl:"/backend/partials/edit/item/button/buttonupdatedialog",targetEvent:null,locals:{items:t}}).then(function(t){var n="";n=t.isPage?"/browse/"+t.items.page:"/write",t.items.path=n,a.Data.Pages[a.Page].items[e]=t.items},function(){})},e.showTextDeleteDialog=function(e){n.show({controller:"TextDeleteDialogController",templateUrl:"/backend/partials/edit/item/check/textdeletedialog",targetEvent:e}).then(function(t){a.Data.Pages[a.Page].items[e]=null,a.Data.Pages[a.Page].items=_.compact(a.Data.Pages[a.Page].items)},function(){})},e.showCheckDeleteDialog=function(e){n.show({controller:"CheckDeleteDialogController",templateUrl:"/backend/partials/edit/item/check/checkdeletedialog",targetEvent:e}).then(function(t){a.Data.Pages[a.Page].items[e]=null,a.Data.Pages[a.Page].items=_.compact(a.Data.Pages[a.Page].items)},function(){})},e.showSelectDeleteDialog=function(e){n.show({controller:"SelectDeleteDialogController",templateUrl:"/backend/partials/edit/item/select/selectdeletedialog",targetEvent:e}).then(function(t){a.Data.Pages[a.Page].items[e]=null,a.Data.Pages[a.Page].items=_.compact(a.Data.Pages[a.Page].items)},function(){})},e.showNumericDeleteDialog=function(e){n.show({controller:"NumericDeleteDialogController",templateUrl:"/backend/partials/edit/item/numeric/numericdeletedialog",targetEvent:e}).then(function(t){a.Data.Pages[a.Page].items[e]=null,a.Data.Pages[a.Page].items=_.compact(a.Data.Pages[a.Page].items)},function(){})},e.showPictureDeleteDialog=function(e){n.show({controller:"PictureDeleteDialogController",templateUrl:"/backend/partials/edit/item/picture/picturedeletedialog",targetEvent:e}).then(function(e){a.Data.Pages[a.Page].picture[0]=null,a.Data.Pages[a.Page].picture=_.compact(a.Data.Pages[a.Page].picture)},function(){})},e.showButtonDeleteDialog=function(e){n.show({controller:"ButtonDeleteDialogController",templateUrl:"/backend/partials/edit/item/button/buttondeletedialog",targetEvent:e}).then(function(t){a.Data.Pages[a.Page].items[e]=null,a.Data.Pages[a.Page].items=_.compact(a.Data.Pages[a.Page].items)},function(){})}):t.go("departments")}]),controllers.controller("FilesController",["$scope","FileQuery",function(e,t){List(t,{},function(t){e.files=t})}]),controllers.controller("ControllpanelController",["$scope","$mdToast","$mdBottomSheet","$mdDialog","Config",function(e,t,n,o,a){var i=new a;i.$get({},function(n){n?(0===n.code&&(e.config=n.value),t.show(t.simple().content(n.message))):t.show(t.simple().content("network error(config)"))}),e.showNotificationDialog=function(){o.show({controller:"NotificationDialogController",templateUrl:"/backend/partials/controll/notification",targetEvent:""}).then(function(n){var o=new a;o.body=e.config,o.$update({},function(e){t.show(e?0===e.code?t.simple().content("Updated."):t.simple().content(e.message):t.simple().content("network error(notification)"))})},function(){})},e.icon="vertical_align_top",e.showConfigSheet=function(t){e.icon="vertical_align_bottom",n.show({templateUrl:"/backend/partials/patient/configsheet",controller:"PatientConfigSheetControl",targetEvent:t}).then(function(t){e.icon="vertical_align_top"},function(){e.icon="vertical_align_top"})}}]),controllers.controller("PatientSheetControl",["$scope","$mdBottomSheet","$location","CurrentPatient",function(e,t,n,o){o&&(e.items=[{name:"PDF",icon:"content_copy"}],e.ItemClick=function(n){t.hide(e.items[n]),window.open("/pdf/"+o.id,o.name,"location=no")})}]),controllers.controller("PatientTotalSheetControl",["$scope","$mdBottomSheet","$location",function(e,t,n){e.items=[],e.ItemClick=function(n){t.hide(e.items[n])}}]),controllers.controller("PatientConfigSheetControl",["$scope","$mdBottomSheet","$location",function(e,t,n){e.items=[],e.ItemClick=function(n){t.hide(e.items[n])}}]),controllers.controller("LoginDialogController",["$scope","$q","$mdDialog","$mdToast","AccountQuery","Login",function(e,t,n,o,a,i){e.querySearch=function(e){var n=t.defer();return a.query({query:encodeURIComponent(JSON.stringify({username:{$regex:e}}))},function(e){n.resolve(e.value)}),n.promise},e.searchTextChange=function(e){},e.selectedItemChange=function(e){},e.hide=function(){n.hide()},e.cancel=function(){n.cancel()},e.answer=function(e){var t=new i;t.username=e.username,t.password=e.password,t.$login(function(e){e?(0===e.code&&n.hide(e),o.show(o.simple().content(e.message))):o.show(o.simple().content("network error(login)"))})}}]),controllers.controller("RegisterDialogController",["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("AccountDeleteDialogController",["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("AccountUpdateDialogController",["$scope","$mdDialog","items",function(e,t,n){e.items=n,e.iconsize="42",e.onEnter=function(){e.iconsize="52"},e.onLeave=function(){e.iconsize="42"},e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.changePassword=function(n){e.a=1,t.hide(e)},e.answer=function(n){e.a=2,t.hide(e)}}]),controllers.controller("NotificationDialogController",["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("PatientAcceptDialogController",["$scope","$mdDialog","ViewQuery","items",function(e,t,n,o){e.items=o,e.categories=[],e.progress=!0,List(n,{},function(t){_.each(t,function(t,n){e.categories.push(t.Name)}),e.progress=!1}),e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("DepartmentCreateDialogController",["$scope","$mdDialog","ViewQuery",function(e,t,n){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("DepartmentCopyDialogController",["$scope","$mdDialog","ViewQuery","items",function(e,t,n,o){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("DepartmentDeleteDialogController",["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("PageCreateDialogController",["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("PageDeleteDialogController",["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("TextCreateDialogController",["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("CheckCreateDialogController",["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("SelectCreateDialogController",["$scope","$mdDialog",function(e,t){var n=_this;n.tags=[],e.tags=angular.copy(n.tags),e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("NumericCreateDialogController",["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("PictureCreateDialogController",["$scope","$mdDialog","$mdToast","File","FileQuery",function(e,t,n,o,a){e.items={},List(a,{},function(t){e.files=t}),e.images=[],e.processFiles=function(t){var i=t[0].name;List(a,{filename:i},function(a){if(a)if(0==a.length){e.items.path=i,e.images[0]={};var r=new FileReader,c=new Image;r.onload=function(t){var n=t.target.result;c.src=n,c.onload=function(){var t=new o;t.url=n,t.$send({name:e.items.path}),e.$apply()}},r.readAsDataURL(t[0].file)}else n.show(n.simple().content("already found."));else n.show(n.simple().content("network error(file)"))})},e.selectFile=function(t){e.items.path=t},e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("PictureUpdateDialogController",["$scope","$mdDialog","File","FileQuery","items",function(e,t,n,o,a){e.items=a,List(o,{},function(t){e.files=t}),e.images=[],e.processFiles=function(t){var o=t[0].name;e.items.path=o,e.images[0]={};var a=new FileReader,i=new Image;a.onload=function(t){var o=t.target.result;i.src=o,i.onload=function(){var t=new n;t.url=o,t.$send({name:e.items.path}),e.$apply()}},a.readAsDataURL(t[0].file)},e.selectFile=function(t){e.items.path=t},e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("ButtonCreateDialogController",["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("CheckUpdateDialogController",["$scope","$mdDialog","items",function(e,t,n){e.items=n,e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("SelectUpdateDialogController",["$scope","$mdDialog","items",function(e,t,n){e.items=n,e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("NumericUpdateDialogController",["$scope","$mdDialog","items",function(e,t,n){e.items=n,e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("ButtonUpdateDialogController",["$scope","$mdDialog","items",function(e,t,n){var o=n.path;if(e.items=n,e.isPage="/write"!=o,e.isPage){var a=o.split("/");3===a.length&&(e.items.page=a[2])}e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("TextDeleteDialogController",["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("CheckDeleteDialogController",["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("SelectDeleteDialogController",["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("NumericDeleteDialogController",["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("PictureDeleteDialogController",["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]),controllers.controller("ButtonDeleteDialogController",["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(n){t.hide(e)}}]);